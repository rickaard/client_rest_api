{"version":3,"sources":["js/main.js"],"names":["outputEl","document","querySelector","submitBtn","formEl","editFormWrapper","editFormEl","editModalEl","addModalEl","addModalBtn","closeModalBtns","querySelectorAll","url","fetchContent","fetch","then","response","json","data","console","log","courses","map","item","index","concat","course_code","course_name","course_progress","course_syllabus","id","join","innerHTML","error","convertToJson","codeInput","nameInput","progressInput","syllabusInput","JSON","stringify","code","name","progress","syllabus","addCourse","event","preventDefault","jsonStr","value","method","headers","Content-Type","body","resp","reset","style","display","err","editModal","editCourse","deleteCourse","window","addEventListener","forEach","element","parentElement","onclick","target"],"mappings":"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","file":"../main.js","sourcesContent":["\"use strict\";\r\n\r\n// Declare element variables\r\nconst outputEl = document.querySelector('#fetch_output');\r\n\r\nconst submitBtn = document.querySelector('#submitBtn');\r\nconst formEl = document.querySelector('#add-course-form');\r\nconst editFormWrapper = document.querySelector('.edit-form');\r\nconst editFormEl = document.querySelector('#edit-course-form');\r\nconst editModalEl = document.querySelector('.edit-modal');\r\nconst addModalEl = document.querySelector('.add-modal');\r\nconst addModalBtn = document.querySelector('#add-modal-btn');\r\nconst closeModalBtns = document.querySelectorAll('.close');\r\n\r\n\r\n// API URL\r\nconst url = 'http://localhost/api/index.php/courses/';\r\n\r\n// Call fetch function when DOM is finnished loading the DOM tree \r\nwindow.addEventListener('DOMContentLoaded', fetchContent);\r\n// Event listeners\r\nformEl.addEventListener('submit', addCourse);\r\n\r\naddModalBtn.addEventListener('click', () => {\r\n    addModalEl.style.display = 'block';\r\n})\r\n\r\n// Modal close button\r\ncloseModalBtns.forEach(element => {\r\n    element.addEventListener('click', () => {\r\n        element.parentElement.parentElement.style.display = 'none';\r\n    })\r\n})\r\n\r\nwindow.onclick = function(event) {\r\n    if (event.target == addModalEl || event.target == editModalEl) {\r\n        addModalEl.style.display = \"none\";\r\n        editModalEl.style.display = \"none\";\r\n    }\r\n  }\r\n\r\n// Fetch content (the courses)\r\nfunction fetchContent()  {\r\n    fetch(url)\r\n    .then(response => response.json())\r\n    .then(data => {\r\n        console.log('fetchContent',data)\r\n        let courses = data.map((item, index) => {\r\n            return `\r\n            <tr class=\"course_wrapper\">\r\n                <td class=\"course-code\">${item.course_code}</td>\r\n                <td class=\"course-name\">${item.course_name}</td>\r\n                <td class=\"course-progress\">${item.course_progress}</td>\r\n                <td class=\"course-syllabus\"><a target=\"_blank\" href=\"${item.course_syllabus}\">Webblänk</a></td>\r\n                <td class=\"course-delete\"><button id=\"${item.id}\" class=\"btn btn-small btn-warning\" onClick=\"deleteCourse(${item.id})\">X</button></td>\r\n                <td class=\"course-delete\"><button class=\"btn btn-small btn-warning\" onClick=\"editModal('${item.course_code}', '${item.course_name}', '${item.course_progress}', '${item.course_syllabus}', ${item.id})\">E</button></td>\r\n            </tr>\r\n            `\r\n        }).join(\"\");\r\n        outputEl.innerHTML = courses;\r\n    })\r\n    .catch(error => console.log(error))\r\n}\r\n\r\n// Convert the argument to a JSON object\r\nfunction convertToJson(codeInput, nameInput, progressInput, syllabusInput) {\r\n    let course_code = codeInput;\r\n    let course_name = nameInput;\r\n    let course_progress = progressInput;\r\n    let course_syllabus = syllabusInput;\r\n\r\n    let jsonStr = JSON.stringify({\r\n        'code': course_code,\r\n        'name': course_name,\r\n        'progress': course_progress,\r\n        'syllabus': course_syllabus\r\n    });\r\n    return jsonStr;\r\n}\r\n\r\n\r\n// Post new course\r\nfunction addCourse (event) {\r\n    event.preventDefault();\r\n\r\n    let jsonStr = convertToJson(document.querySelector('#course_code').value, document.querySelector('#course_name').value, document.querySelector('#course_progress').value, document.querySelector('#course_syllabus').value)\r\n\r\n    fetch(url, {\r\n        method: 'POST',\r\n        headers: {\r\n            'Content-Type': 'application/json'\r\n        },\r\n        body: jsonStr\r\n    })\r\n    .then(resp => resp.json())\r\n    .then(data => {\r\n        console.log(data); // SKRIV UT ATT KURS ÄR TILLAGD ---------------------- OBSBSBOSBSOBSOBSOBSOBSOBS FIXA\r\n        fetchContent(); // Fetching all the courses again when a new course is added\r\n        formEl.reset(); // Resets the input fields in the form\r\n        addModalEl.style.display = 'none';\r\n    })\r\n    .catch(err => console.log(err))\r\n}\r\n\r\n// Open edit modal\r\nfunction editModal(code, name, progress, syllabus, id) {\r\n    // console.log(code, name, progress, syllabus, id);\r\n\r\n    document.querySelector('#edit-course-form > div > #course_code').value = code;\r\n    document.querySelector('#edit-course-form > div > #course_name').value = name;\r\n    document.querySelector('#edit-course-form > div > #course_progress').value = progress;\r\n    document.querySelector('#edit-course-form > div > #course_syllabus').value = syllabus;\r\n    document.querySelector('#edit-course-form > div > #course_id').value = id;\r\n\r\n    editModalEl.style.display = 'block';\r\n    console.log(code, name, progress, syllabus, id);\r\n}\r\n\r\n\r\n// Edit course\r\nfunction editCourse(code) {\r\n    // event.preventDefault();\r\n    \r\n    console.log(code);\r\n    \r\n\r\n    // fetch(url, {\r\n    //     method: 'PUT',\r\n    //     header: {\r\n    //         'Content-Type': 'application/json'\r\n    //     },\r\n    //     body: jsonStr\r\n    // })\r\n    // .then(resp => resp.json())\r\n    // .then(data => {\r\n    //     console.log(data);\r\n    //     fetchContent();\r\n    //     // reset form inputs\r\n    // })\r\n}\r\n\r\n// Delete course\r\nfunction deleteCourse(id) {\r\n    console.log(id);\r\n    fetch(url+id, {\r\n        method: 'DELETE'\r\n    })\r\n    .then(resp => resp.json())\r\n    .then(data => {\r\n        console.log(data);\r\n        fetchContent(); // Fetching all the courses again when a course is removed \r\n    })\r\n    .catch(err => console.log(err))\r\n}\r\n\r\n\r\ndocument.querySelectorAll('.course-delete > button').forEach(element => {\r\n    element.addEventListener('click', deleteCourse);\r\n    console.log(element);\r\n    deleteCourse()\r\n});\r\n\r\n\r\n"]}